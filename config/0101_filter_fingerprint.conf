filter {
    if [input][type] == "syslog" {
        mutate {
            add_field => {"[@metadata][fingerprint_time]" => "%{+YYYYMMddHH}"}
        }

        fingerprint {
            source => ['[@metadata][fingerprint_time]', 'log.original', 'host.ip', 'message']
            method => 'SHA1'
            concatenate_sources => 'true'
            target => "[@metadata][fingerprint]"
        }
    }
}

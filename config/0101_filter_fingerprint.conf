filter {
    if [input][type] == "syslog" {
        fingerprint {
            source => ['log.original', 'host.ip', 'message']
            method => 'SHA1'
            concatenate_sources => 'true'
            target => "[@metadata][fingerprint]"
        }
    }
}
